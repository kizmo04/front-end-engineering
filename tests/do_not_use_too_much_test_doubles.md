# 테스트 대역(Test Double)을 무분별하게 사용하지 않습니다.

### 테스트 대역이란?

테스트 대역이란 실제 구현체를 테스트하기가 곤란할 때 대신 사용하는 대역을 뜻합니다. 마틴 파울러는 [자신의 글](https://martinfowler.com/articles/mocksArentStubs.html)에서 테스트 대역을 Dummy, Fake, Stub, Mock의 네 가지로 구분한 적이 있습니다.

- Dummy: 보통 빈 몸체를 가지며 아무 것도 하지 않음. 컴파일이나 참조 에러를 막는 용도.
- Fake: Dummy와 다르게 몸체가 있지만 거짓으로 구현. 제품(Production) 레벨에서 쓰일 수는 없는 의사(Pseudo) 구현체.
- Stub: 미리 정의한 응답을 일관성있게 반환하는 함수. 어떤 Stub은 호출과 응답을 기록하기도 함.
- Mock: 입력에 대응하는 기대 결과를 동적으로 설정할 수 있는 개체나 함수.

어디까지나 참고할 기준일 뿐 각 테스트 대역 간의 경계는 분명하지 않습니다. 사람마다 다르게 정의하기도 합니다. 호출과 응답을 기록하는 테스트 대역을 어떤 사람은 Spy로 구분해서 부르기도 합니다.

풍부한 테스트 대역을 제공하는 JavaScript 라이브러리로 [Sinon.js](https://sinonjs.org/)가 있습니다.

### 테스트 대역을 사용할 때 주의할 점!

테스트 대역을 사용하면 테스트를 하기 곤란한 상황을 간단하게 벗어날 수 있는 이점이 있습니다.

하지만 공짜는 없습니다. 테스트 대역은 구현 코드의 대체물을 만듦으로써 테스트 코드와 구현 코드 사이의 의존성을 높입니다. 그리고 중복 코드를 작성하게 만듭니다. 구현 코드에 변경이 생기면 테스트 대역도 변경을 해줘야 하기에 번거로운 일이 됩니다.

실제로 동기화를 해야하는 걸 까먹고 테스트를 방치하는 걸 현업에서 대단히 여러 번 보았습니다.

테스트 대역은 개발자를 안티 패턴으로 유도합니다. Spy로 내부 의존 개체의 호출 횟수를 확인하는 경우 처럼, 테스트 대상의 인터페이스가 아닌 상세 구현을 테스트하는 경우가 그렇습니다.

테스트 대역은 정말 필요한 순간에만 최소한으로 사용하세요!
